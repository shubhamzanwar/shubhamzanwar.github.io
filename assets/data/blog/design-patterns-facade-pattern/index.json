{"hash":"2c3a0ba7cf6c0bcadb8cd164032e4785b4e1327f","data":{"post":{"id":"14d66b128937be254db0310f47b2b671","title":"Design Patterns: Facade Pattern üé≠","content":"<p>The facade pattern is a structural design pattern, commonly used when there is some interaction with a complex external library or service.</p>\n<p>In this pattern, we create a class to encapsulate the interactions with the 3rd party library. This class is called the Facade. This allows us to expose a simpler interface to the rest of our application. Developers working on other parts of our system need not learn the 3rd party library; rather, they need to only interface with the facade class we create.</p>\n<p>This serves a few crucial purposes:</p>\n<ol>\n<li>In case the 3rd party system is super complex and requires multiple steps to perform a single action, we can encapsulate all of that in a single function in our facade.</li>\n<li>We can easily switch out one 3rd party library for another and still maintain the same interface for our facade. This flexibility is one of the main selling points for the facade.</li>\n<li>We can also filter out any extra functionality from the external service that we don't really require in our application. This is very common while using the facade pattern because external libraries can be very comprehensive and we may not require all the features offered.</li>\n</ol>\n<p>Let's take an example of using the facade pattern</p>\n<h3 id=\"amazon-order-system\"><a href=\"#amazon-order-system\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Amazon order system</h3>\n<p>Let's picture that you're building the module that deals with the placement of orders at Amazon. While building this, you have realized that there are several steps to placing an order; each step involving interactions with several other systems/modules.</p>\n<blockquote>\n<p>Note: This probably is not how Amazon has implemented it's order system. This is just a simplistic representation of what it <em>could be</em></p>\n</blockquote>\n<p>Let's list out the steps:</p>\n<ol>\n<li>Authenticate the user - Users service</li>\n<li>Verify product's availability - Products service</li>\n<li>Assign product to user - Products service</li>\n<li>Make payment - Payments service</li>\n<li>Send notification to dealer - Notification service</li>\n</ol>\n<p>All of that on the click of a button üò±</p>\n<p>Normally, if you were to directly integrate all the systems and services on the button's click, it would hamper the code's readability and would also make it a nightmare to switch one service for another (Imagine a case where you would revamp the products service)</p>\n<p>To solve for all this, we can create a facade class that deals with all this and exposes a function called <code>placeOrder</code> that takes a <code>productId</code> and <code>userId</code> to complete all the above steps üëÜüèΩ</p>\n<p>Let's implement this solution in go</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> orderFacade <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    userService UserService\n    productService ProductService\n    paymentService PaymentService\n    notificationService NotificationService\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>o <span class=\"token operator\">*</span>orderFacade<span class=\"token punctuation\">)</span> <span class=\"token function\">placeOrder</span><span class=\"token punctuation\">(</span>userId <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> productId <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[Facade] Starting order placement\"</span><span class=\"token punctuation\">)</span>\n\n    userValid <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span>userService<span class=\"token punctuation\">.</span><span class=\"token function\">isUserValid</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span>\n    productAvailable <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span>productService<span class=\"token punctuation\">.</span><span class=\"token function\">productAvailable</span><span class=\"token punctuation\">(</span>productId<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> userValid <span class=\"token operator\">&amp;&amp;</span> productAvailable <span class=\"token punctuation\">{</span>\n        o<span class=\"token punctuation\">.</span>productService<span class=\"token punctuation\">.</span><span class=\"token function\">assignProductToUser</span><span class=\"token punctuation\">(</span>productId<span class=\"token punctuation\">,</span> userId<span class=\"token punctuation\">)</span>\n        o<span class=\"token punctuation\">.</span>paymentService<span class=\"token punctuation\">.</span><span class=\"token function\">makePayment</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">,</span> productId<span class=\"token punctuation\">)</span>\n        o<span class=\"token punctuation\">.</span>notificationService<span class=\"token punctuation\">.</span><span class=\"token function\">notifyDealer</span><span class=\"token punctuation\">(</span>productId<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Let's also take a look at the other services' code</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> UserService <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>u <span class=\"token operator\">*</span>UserService<span class=\"token punctuation\">)</span> <span class=\"token function\">isUserValid</span><span class=\"token punctuation\">(</span>userId <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">bool</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[UserService] validating the user: \"</span><span class=\"token punctuation\">,</span> userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Complex logic for checking validity</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> ProductService <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>ProductService<span class=\"token punctuation\">)</span> <span class=\"token function\">productAvailable</span><span class=\"token punctuation\">(</span>productId <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">bool</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[ProductService] checking availability of product: \"</span><span class=\"token punctuation\">,</span> productId<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// Complex logic for checking availability</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>ProductService<span class=\"token punctuation\">)</span> <span class=\"token function\">assignProductToUser</span><span class=\"token punctuation\">(</span>productId <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> userId <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[ProductService] assigning product %s to user %s\\n\"</span><span class=\"token punctuation\">,</span> productId<span class=\"token punctuation\">,</span> userId<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// complex logic for product assignment</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> PaymentService <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>PaymentService<span class=\"token punctuation\">)</span> <span class=\"token function\">makePayment</span><span class=\"token punctuation\">(</span>userId <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> productId <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[PaymentService] charging user %s for product %s\\n\"</span><span class=\"token punctuation\">,</span> userId<span class=\"token punctuation\">,</span> productId<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// complex logic for making payment</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> NotificationService <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">*</span>NotificationService<span class=\"token punctuation\">)</span> <span class=\"token function\">notifyDealer</span><span class=\"token punctuation\">(</span>productId <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[NotificationService] notifying dealer about sale of product %s\\n\"</span><span class=\"token punctuation\">,</span> productId<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// complex notification logic</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Oooh, so now we have our dummy services and completely legit facade in place üíÅüèª‚Äç‚ôÇÔ∏è - It's time to test it out</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    orderModule <span class=\"token operator\">:=</span> <span class=\"token operator\">&amp;</span>orderFacade<span class=\"token punctuation\">{</span>\n        userService<span class=\"token punctuation\">:</span>  UserService<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        productService<span class=\"token punctuation\">:</span>  ProductService<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        paymentService<span class=\"token punctuation\">:</span>  PaymentService<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        notificationService<span class=\"token punctuation\">:</span>  NotificationService<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n\n    userId <span class=\"token operator\">:=</span> <span class=\"token string\">\"test-user-id\"</span>\n    productId <span class=\"token operator\">:=</span> <span class=\"token string\">\"test-product-id\"</span>\n\n\n    orderModule<span class=\"token punctuation\">.</span><span class=\"token function\">placeOrder</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">,</span> productId<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>When you run your program, you should see something like this in the output:</p>\n<pre class=\"language-text\"><code class=\"language-text\">[Facade] Starting order placement\n[UserService] validating the user:  test-user-id\n[ProductService] checking availability of product:  test-product-id\n[ProductService] assigning product test-product-id to user test-user-id\n[PaymentService] charging user test-user-id for product test-product-id\n[NotificationService] notifying dealer about sale of product test-product-id</code></pre>\n<p>You can notice from the code and the output that the facade only is the surface layer of the functionality. The actual action may happen in the external services and it is still abstracted away from the user of the facade by exposing a super simple interface.</p>\n<p>That's the facade pattern in a gist üòÅ</p>\n<p>You can find all the code for this tutorial on this <a href=\"https://github.com/shubhamzanwar/design-patterns\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this github repo</a></p>\n<p>Cheers ‚òïÔ∏è</p>\n","date":"16 Oct 2020","timeToRead":3,"coverImage":"/img/design-pattern.jpg","subTitle":"Taking a look at the facade design pattern with an implementation in go","coverCredit":"Photo by <a href=\"https://unsplash.com/@eskandthewood?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Silvio Kundt</a> on <a href=\"https://unsplash.com/s/photos/pattern?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Unsplash</a>"}},"context":{}}