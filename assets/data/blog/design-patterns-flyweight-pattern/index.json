{"hash":"72212bbc7b59659ad2d9b825559bfe91c41a9e20","data":{"post":{"id":"93c8b1ba9851ec0bfc99523f377dd661","title":"Design Patterns: Flyweight Pattern ‚öñÔ∏è","content":"<p>The Flyweight design pattern is a structural design pattern commonly used when we want to group similar data for multiple objects. The primary intent of this pattern is to store common data for multiple objects in a single place and hence optimise for memory usage.</p>\n<p>Let's understand this pattern by taking the case of a sneaker store üëü</p>\n<h3 id=\"sneaker-store\"><a href=\"#sneaker-store\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Sneaker Store</h3>\n<p>Imagine running an online sneaker store. You've noticed that your customers always have a lot of questions and so, you've maintained every little detail about each pair of sneakers you have on display! üóÉ </p>\n<p>You have the following data points on <strong>every</strong> single pair:</p>\n<ul>\n<li>Name</li>\n<li>Size</li>\n<li>Color</li>\n<li>Brand</li>\n<li>Price</li>\n<li>Materials Used</li>\n<li>Description</li>\n<li>Sample Image</li>\n<li>laced</li>\n</ul>\n<p>You soon realized that for a given <em>type</em> of pair, you're storing the same information again and again. Take the case of the Nike Air Force 1. For any two pairs, the only thing different is the <code>size</code> and the <code>color</code>. Everything else is duplicate information üò±</p>\n<p>This definitely isn't the best way to store the details because it's super memory intensive ad costly. To solve this problem, you decide to create an object to store all the <em>common</em> details of the shoe and store only the <code>size</code>, <code>color</code> and a reference to the \"common object\" with every shoe instance.</p>\n<p>If all of this is confusing, don't worry. Taking a look at the code should make things easier üòâ</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> SneakerDetails <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n\tname        <span class=\"token builtin\">string</span>\n\tbrand       <span class=\"token builtin\">string</span>\n\tprice       <span class=\"token builtin\">float64</span>\n\tmaterials   <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span>\n\tdescription <span class=\"token builtin\">string</span>\n\timage       <span class=\"token builtin\">string</span>\n\tlaced       <span class=\"token builtin\">bool</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> NikeAirForceDetails <span class=\"token operator\">=</span> SneakerDetails<span class=\"token punctuation\">{</span>\n\tname<span class=\"token punctuation\">:</span>        <span class=\"token string\">\"Nike Air Force 1\"</span><span class=\"token punctuation\">,</span>\n\tbrand<span class=\"token punctuation\">:</span>       <span class=\"token string\">\"Nike\"</span><span class=\"token punctuation\">,</span>\n\tprice<span class=\"token punctuation\">:</span>       <span class=\"token number\">144.99</span><span class=\"token punctuation\">,</span>\n\tmaterials<span class=\"token punctuation\">:</span>   <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"leather\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rubber\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tdescription<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Originally released in 1982, the Nike Air Force 1 was the first Nike model to feature Air technology.\"</span><span class=\"token punctuation\">,</span>\n\timage<span class=\"token punctuation\">:</span>       <span class=\"token string\">\"https://via.placeholder.com/50\"</span><span class=\"token punctuation\">,</span>\n\tlaced<span class=\"token punctuation\">:</span>       <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> AdidasSuperstarDetails <span class=\"token operator\">=</span> SneakerDetails<span class=\"token punctuation\">{</span>\n\tname<span class=\"token punctuation\">:</span>        <span class=\"token string\">\"Adidas Superstar\"</span><span class=\"token punctuation\">,</span>\n\tbrand<span class=\"token punctuation\">:</span>       <span class=\"token string\">\"Adidas\"</span><span class=\"token punctuation\">,</span>\n\tprice<span class=\"token punctuation\">:</span>       <span class=\"token number\">85.99</span><span class=\"token punctuation\">,</span>\n\tmaterials<span class=\"token punctuation\">:</span>   <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"leather\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rubber\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tdescription<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Originally made for basketball courts in the '70s.\"</span><span class=\"token punctuation\">,</span>\n\timage<span class=\"token punctuation\">:</span>       <span class=\"token string\">\"https://via.placeholder.com/50\"</span><span class=\"token punctuation\">,</span>\n\tlaced<span class=\"token punctuation\">:</span>       <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">(</span>\n\tNikeAirForce <span class=\"token operator\">=</span> <span class=\"token string\">\"Nike Air Force 1\"</span>\n\tAdidasSuperstar <span class=\"token operator\">=</span> <span class=\"token string\">\"Adidas Superstar\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">var</span> DetailsMap <span class=\"token operator\">=</span> <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span>SneakerDetails<span class=\"token punctuation\">{</span>\n\tNikeAirForce<span class=\"token punctuation\">:</span>    NikeAirForceDetails<span class=\"token punctuation\">,</span>\n\tAdidasSuperstar<span class=\"token punctuation\">:</span> AdidasSuperstarDetails<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">getShoeDetails</span><span class=\"token punctuation\">(</span>shoeType <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> SneakerDetails <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> DetailsMap<span class=\"token punctuation\">[</span>shoeType<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> Sneaker <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    shoeType <span class=\"token builtin\">string</span>\n    size <span class=\"token builtin\">int</span>\n    color <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">*</span>Sneaker<span class=\"token punctuation\">)</span> <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    details <span class=\"token operator\">:=</span> <span class=\"token function\">getShoeDetails</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span>shoeType<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The %s is of size %d, color %s and costs %.2f. The Manufacturer is %s\"</span><span class=\"token punctuation\">,</span> details<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> s<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> details<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">,</span> details<span class=\"token punctuation\">.</span>brand<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Looking through the code written so far, we've created the details object for each type of shoe in our shop using a common struct. This way, we can add descriptions for more sneakers in the future ü§î</p>\n<p>We've also created a map of the shoe type against the respective type. This way, every instance of the <code>Sneaker</code> struct can easily access the corresponding details.</p>\n<p>Also notice that our <code>Sneaker</code> struct now only contains the <code>size</code>, <code>color</code> along with the <code>shoeType</code> that allows us to fetch it's other details.</p>\n<p>Let's see this in action</p>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tsneaker1 <span class=\"token operator\">:=</span> Sneaker<span class=\"token punctuation\">{</span>\n\t\tshoeType<span class=\"token punctuation\">:</span> NikeAirForce<span class=\"token punctuation\">,</span>\n\t\tsize<span class=\"token punctuation\">:</span>     <span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n\t\tcolor<span class=\"token punctuation\">:</span>    <span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tsneaker2 <span class=\"token operator\">:=</span> Sneaker<span class=\"token punctuation\">{</span>\n\t\tshoeType<span class=\"token punctuation\">:</span> AdidasSuperstar<span class=\"token punctuation\">,</span>\n\t\tsize<span class=\"token punctuation\">:</span>     <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\n\t\tcolor<span class=\"token punctuation\">:</span>    <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>sneaker1<span class=\"token punctuation\">.</span><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>sneaker2<span class=\"token punctuation\">.</span><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>This should give the following output:</p>\n<pre class=\"language-text\"><code class=\"language-text\">The Nike Air Force 1 is of size 9, color white and costs 144.99. The Manufacturer is Nike\nThe Adidas Superstar is of size 8, color black and costs 85.99. The Manufacturer is Adidas</code></pre>\n<p>That's about it for the Flyweight pattern! üòÅ</p>\n<p>Note that one added benefit of this pattern (apart from memory efficiency) is also the fact that updating the common details, like price, for a type of sneaker would require you to make the change in only one place - the common details object as opposed to making the change in every individual instance of the sneaker</p>\n<p>You can find all the code for this tutorial on this <a href=\"https://github.com/shubhamzanwar/design-patterns\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this github repo</a></p>\n<p>Cheers ‚òïÔ∏è</p>\n","date":"31 Oct 2020","timeToRead":3,"coverImage":"/img/design-pattern-flyweight.jpg","subTitle":"Taking a look at the flyweight design pattern with an implementation in go","coverCredit":"Photo by <a href=\"https://unsplash.com/@1walter2?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Johann Walter Bantz</a> on <a href=\"https://unsplash.com/s/photos/boxing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Unsplash</a>"}},"context":{}}