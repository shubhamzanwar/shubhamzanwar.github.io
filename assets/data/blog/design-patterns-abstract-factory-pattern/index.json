{"hash":"2deaf12b007065468d56ce2caeaae52dadeec3ef","data":{"post":{"id":"1963fac31b126ba0f5ad0c339a4de008","title":"Design Patterns: Abstract Factory Pattern üè≠","content":"<p>Abstract Factory pattern is a creational design pattern. It is used when we need to create multiple families of similar products.</p>\n<p>Let us understand this pattern using the example of a pizza chain</p>\n<h3 id=\"pizza-shops\"><a href=\"#pizza-shops\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Pizza Shops</h3>\n<p>Assume that you are the head of a business that opens up pizza stores around town. One of your many responsibilities is to maintain all food items (in this case, pizzas and garlic bread) in a given store to belong to the same brand - either dominos or pizza hut.</p>\n<p>There are multiple ways you could go about it. One of the simplest that comes to mind is to create a factory for creating pizzas of either pizza hut or dominos type and another similar factory for garlic bread.</p>\n<blockquote>\n<p>Note: If you're not sure about how normal factories work, you can take a look at <a href=\"/blog/design-patterns-factory-pattern\">this example</a></p>\n</blockquote>\n<p>The drawback of having separate factories is that now we trust the user, at a given store, to choose the correct type of pizza, garlic bread they want. If they ever make the mistake of serving a dominos pizza with a pizza hut garlic bread, your customers are going to be mad and you'd also be violating your make-believe contract with each of these chains.</p>\n<p>Don't worry. <strong><em>There's a simpler way</em></strong></p>\n<p>Instead of creating a factory over each individual product (pizzas and garlic bread), you could create a factory for each individual brand. Enforce both these factories to have provision for <code>creating a pizza</code> and <code>creating a garlic bread</code>.</p>\n<p>Then, while setting up the store, you could give the store manager either a pizza hut factory or a dominos factory and then confidently rest that they won't be accidentally mixing-and-matching products.</p>\n<p>Let's translate this to code:</p>\n<p>Before we begin writing the factories, let's first create the products:</p>\n<h5 id=\"generic-pizza\"><a href=\"#generic-pizza\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Generic Pizza</h5>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> iPizza <span class=\"token keyword\">interface</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">GetPrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">float64</span>\n    <span class=\"token function\">GetName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span>\n    <span class=\"token function\">GetToppings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> pizza <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    name     <span class=\"token builtin\">string</span>\n    price    <span class=\"token builtin\">float64</span>\n    toppings <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>pizza<span class=\"token punctuation\">)</span> <span class=\"token function\">GetName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> p<span class=\"token punctuation\">.</span>name\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>pizza<span class=\"token punctuation\">)</span> <span class=\"token function\">GetPrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">float64</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> p<span class=\"token punctuation\">.</span>price\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>pizza<span class=\"token punctuation\">)</span> <span class=\"token function\">GetToppings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> p<span class=\"token punctuation\">.</span>toppings\n<span class=\"token punctuation\">}</span></code></pre>\n<h5 id=\"branded-pizzas\"><a href=\"#branded-pizzas\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Branded Pizzas</h5>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> pizzaHutPizza <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    pizza\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> dominosPizza <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    pizza\n<span class=\"token punctuation\">}</span></code></pre>\n<h5 id=\"generic-garlic-bread\"><a href=\"#generic-garlic-bread\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Generic Garlic Bread</h5>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> iGarlicBread <span class=\"token keyword\">interface</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">GetPrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">float64</span>\n    <span class=\"token function\">GetName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> garlicBread <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    name  <span class=\"token builtin\">string</span>\n    price <span class=\"token builtin\">float64</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>g <span class=\"token operator\">*</span>garlicBread<span class=\"token punctuation\">)</span> <span class=\"token function\">GetName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> g<span class=\"token punctuation\">.</span>name\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>g <span class=\"token operator\">*</span>garlicBread<span class=\"token punctuation\">)</span> <span class=\"token function\">GetPrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">float64</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> g<span class=\"token punctuation\">.</span>price\n<span class=\"token punctuation\">}</span></code></pre>\n<h5 id=\"branded-garlic-bread\"><a href=\"#branded-garlic-bread\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Branded Garlic Bread</h5>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> pizzaHutGarlicBread <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    garlicBread\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">type</span> dominosGarlicBread <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    garlicBread\n<span class=\"token punctuation\">}</span></code></pre>\n<p>We have created both our products. They both implement a common interface, making it easier for the end user to consume them. Pun intended üòâ</p>\n<p>Let's now look at how we can create the factories for each of these:</p>\n<h5 id=\"generic-factory\"><a href=\"#generic-factory\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Generic Factory</h5>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> iPizzaFactory <span class=\"token keyword\">interface</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">createPizza</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> iPizza\n    <span class=\"token function\">createGarlicBread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> iGarlicBread\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Now, both, <code>PizzaHutFactory</code> and <code>DominosFactory</code> can implement this interface to ensure that they expose uniform functionality</p>\n<h5 id=\"branded-factories\"><a href=\"#branded-factories\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Branded Factories</h5>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> PizzaHutFactory <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>PizzaHutFactory<span class=\"token punctuation\">)</span> <span class=\"token function\">createPizza</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> iPizza <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>pizzaHutPizza<span class=\"token punctuation\">{</span>\n        pizza<span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span>     <span class=\"token string\">\"pepperoni\"</span><span class=\"token punctuation\">,</span>\n            price<span class=\"token punctuation\">:</span>    <span class=\"token number\">230.3</span><span class=\"token punctuation\">,</span>\n            toppings<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"olives\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mozzarella\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pork\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>p <span class=\"token operator\">*</span>pizzaHutFactory<span class=\"token punctuation\">)</span> <span class=\"token function\">createGarlicBread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> iGarlicBread <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>pizzaHutGarlicBread<span class=\"token punctuation\">{</span>\n        garlicBread<span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span>  <span class=\"token string\">\"garlic bread\"</span><span class=\"token punctuation\">,</span>\n            price<span class=\"token punctuation\">:</span> <span class=\"token number\">180.99</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> dominosFactory <span class=\"token keyword\">struct</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>d <span class=\"token operator\">*</span>dominosFactory<span class=\"token punctuation\">)</span> <span class=\"token function\">createPizza</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> iPizza <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>dominosPizza<span class=\"token punctuation\">{</span>\n        pizza<span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span>     <span class=\"token string\">\"margherita\"</span><span class=\"token punctuation\">,</span>\n            price<span class=\"token punctuation\">:</span>    <span class=\"token number\">200.5</span><span class=\"token punctuation\">,</span>\n            toppings<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"tomatoes\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"basil\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"olive oil\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>d <span class=\"token operator\">*</span>dominosFactory<span class=\"token punctuation\">)</span> <span class=\"token function\">createGarlicBread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> iGarlicBread <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>dominosGarlicBread<span class=\"token punctuation\">{</span>\n        garlicBread<span class=\"token punctuation\">{</span>\n            name<span class=\"token punctuation\">:</span>  <span class=\"token string\">\"cheesy bread sticks\"</span><span class=\"token punctuation\">,</span>\n            price<span class=\"token punctuation\">:</span> <span class=\"token number\">150.00</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>We can now choose between either of the factories and then continue creating either pizzas or garlic bread and be absolutely sure that any product from a factory will always belong to the same family/brand of products.</p>\n<p><strong><em>We're almost there</em></strong>. Let's wrap this up by creating a factory that will return the factory of our choice. Confusing? ü§Ø Give it a minute and read that sentence again üòã</p>\n<p>Basically, think of our factories as just another object. Now, based on what type or pizza store we want to set up, (pizza hut or dominos), we can make request for that particular factory (just another object). To automatically get these \"objects\", we can create another factory that would return one of these.</p>\n<p>Some code to help you out:</p>\n<h5 id=\"factory-of-factories\"><a href=\"#factory-of-factories\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Factory of factories</h5>\n<pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">getPizzaFactory</span><span class=\"token punctuation\">(</span>chain <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>iPizzaFactory<span class=\"token punctuation\">,</span> <span class=\"token builtin\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> chain <span class=\"token operator\">==</span> <span class=\"token string\">\"P\"</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>pizzaHutFactory<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> chain <span class=\"token operator\">==</span> <span class=\"token string\">\"D\"</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">&amp;</span>dominosFactory<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">nil</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">nil</span><span class=\"token punctuation\">,</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Enter a valid chain type next time\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Maybe this makes more sense üí°üòÅ</p>\n<p>The main point to remember is this: The abstract factory pattern implements a factory of factories. These inner factories can be used to create products that belong to a particular kind.</p>\n<p>You can find all the code for this tutorial on <a href=\"https://github.com/shubhamzanwar/design-patterns\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this github repo</a></p>\n<p>Cheers ‚òïÔ∏è</p>\n","date":"01 Oct 2020","timeToRead":3,"coverImage":"/img/design-pattern.jpg","subTitle":"Taking a look at the abstract factory design pattern with an implementation in go","coverCredit":"Photo by <a href=\"https://unsplash.com/@eskandthewood?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Silvio Kundt</a> on <a href=\"https://unsplash.com/s/photos/pattern?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\">Unsplash</a>"}},"context":{}}